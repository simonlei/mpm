# MPM 相册管理系统 - 项目总览

## 📋 项目简介

MPM (Multi-Photo Manager) 是一个功能完善的相册管理系统，支持照片浏览、人脸识别、地理位置展示、活动管理等功能。

## 🏗️ 系统架构

```
mpm-go/
├── 后端 (Go + Gin)
│   ├── API 服务
│   ├── 数据库操作
│   ├── 腾讯云 COS 存储
│   ├── 腾讯云人脸识别
│   └── 腾讯地图 API
│
└── 前端 (Vue 3 + TypeScript + TDesign)
    ├── 用户界面
    ├── 状态管理
    ├── 路由管理
    └── API 调用
```

## 🎯 核心功能

### 1. 照片管理
- ✅ 照片浏览（网格/列表）
- ✅ 照片搜索和过滤
- ✅ 照片收藏
- ✅ 照片详情查看
- ✅ 照片信息编辑
- ✅ 批量操作

### 2. 时间线
- ✅ 按年月树形展示
- ✅ 活动分组显示
- ✅ 收藏过滤
- ✅ 快速定位

### 3. 地图功能
- ✅ 交互式地图展示
- ✅ 照片位置标记
- ✅ 点击查看详情
- ✅ 自动聚焦

### 4. 人脸识别
- ✅ 自动人脸检测
- ✅ 人脸分组
- ✅ 人脸命名
- ✅ 人脸搜索
- ✅ 人脸合并
- ✅ 人脸隐藏/收藏

### 5. 活动管理
- ✅ 活动创建
- ✅ 活动编辑
- ✅ 活动删除
- ✅ 活动关联照片
- ✅ 时间范围设置
- ✅ 位置信息设置

### 6. 文件夹管理
- ✅ 文件夹树形展示
- ✅ 批量修改日期
- ✅ 批量修改位置
- ✅ 文件夹移动
- ✅ 文件夹合并

### 7. 上传功能
- ✅ 拖拽上传
- ✅ 批量上传
- ✅ 进度显示
- ✅ 支持图片和视频
- ✅ 自动提取 EXIF

### 8. 回收站
- ✅ 照片恢复
- ✅ 永久删除
- ✅ 批量操作
- ✅ 清空回收站
- ✅ 异步任务进度

### 9. 用户系统
- ✅ 用户登录
- ✅ 签名认证
- ✅ 权限管理
- ✅ 用户管理（管理员）

## 💻 技术栈

### 后端
- **语言**: Go 1.21+
- **框架**: Gin
- **数据库**: MySQL/MariaDB
- **ORM**: GORM
- **存储**: 腾讯云 COS
- **AI**: 腾讯云人脸识别
- **地图**: 腾讯地图 API
- **配置**: Viper

### 前端
- **框架**: Vue 3.4
- **语言**: TypeScript 5.3
- **构建**: Vite 5.0
- **UI**: TDesign Vue Next 1.8
- **状态**: Pinia 2.1
- **路由**: Vue Router 4.2
- **HTTP**: Axios 1.6
- **地图**: Leaflet 1.9
- **日期**: Day.js 1.11

## 📁 项目结构

```
mpm-go/
├── 后端源码
│   ├── main.go              # 入口文件
│   ├── web.go               # 响应封装
│   ├── config.go            # 配置管理
│   ├── db.go                # 数据库连接
│   ├── activity.go          # 活动管理
│   ├── pics.go              # 照片管理
│   ├── pics_date.go         # 时间线
│   ├── face.go              # 人脸识别
│   ├── folder.go            # 文件夹管理
│   ├── gis.go               # 地理信息
│   ├── upload.go            # 文件上传
│   ├── user.go              # 用户管理
│   ├── tags.go              # 标签管理
│   ├── pic_actions.go       # 照片操作
│   ├── progress.go          # 任务进度
│   ├── cos.go               # COS 操作
│   ├── utils.go             # 工具函数
│   └── model/               # 数据模型
│       ├── t_photo.go
│       ├── t_activity.go
│       ├── t_face.go
│       ├── t_file.go
│       ├── t_user.go
│       └── ...
│
├── web/                     # 前端源码
│   ├── src/
│   │   ├── api/            # API 定义
│   │   ├── assets/         # 静态资源
│   │   ├── components/     # 公共组件
│   │   ├── layout/         # 布局组件
│   │   ├── router/         # 路由配置
│   │   ├── stores/         # 状态管理
│   │   ├── utils/          # 工具函数
│   │   ├── views/          # 页面组件
│   │   ├── App.vue         # 根组件
│   │   └── main.ts         # 入口文件
│   ├── package.json        # 依赖配置
│   ├── vite.config.ts      # Vite 配置
│   ├── tsconfig.json       # TS 配置
│   ├── README.md           # 前端文档
│   └── QUICK_START.md      # 快速开始
│
├── API文档.md               # API 接口文档
├── 项目总览.md              # 本文档
├── go.mod                  # Go 模块配置
├── go.sum                  # Go 依赖锁定
└── README.md               # 项目说明
```

## 🚀 快速开始

### 1. 环境要求

**后端**:
- Go 1.21+
- MySQL 5.7+ / MariaDB 10.3+
- 腾讯云账号（COS、人脸识别、地图 API）

**前端**:
- Node.js 16+
- npm 7+

### 2. 后端启动

```bash
# 配置数据库和腾讯云服务
# 编辑配置文件（根据项目具体配置方式）

# 运行后端
cd /root/mpm/mpm-go
go run .
# 或
./mpm-go
```

### 3. 前端启动

```bash
# 安装依赖
cd /root/mpm/mpm-go/web
npm install

# 启动开发服务器
npm run dev

# 访问 http://localhost:3000
```

### 4. 生产部署

**前端构建**:
```bash
cd web
npm run build
```

**部署方式**:
1. 静态文件部署到 Nginx/CDN
2. 或配置后端提供静态文件服务

详见 `web/QUICK_START.md`

## 🔐 认证机制

系统使用签名验证机制：

1. 用户登录时，服务器返回 `signature`
2. 后续请求在 Header 中携带：
   - `Signature`: MD5(account + login_token + timestamp)
   - `Account`: 用户账号

3. 服务器验证签名有效性

## 📊 数据库设计

### 主要表结构

- `t_photos` - 照片信息
- `t_activity` - 活动信息
- `t_face` - 人脸信息
- `photo_face_info` - 照片人脸关联
- `t_files` - 文件/文件夹结构
- `photo_tags` - 照片标签
- `t_user` - 用户信息
- `meta` - 系统元数据

## 🎨 UI 设计

### 布局结构
- 左侧：导航菜单
- 顶部：标题栏 + 用户信息
- 主区域：内容展示

### 配色方案
- 主色：TDesign 品牌色
- 背景：浅灰色容器
- 强调：渐变背景（登录页）

### 响应式设计
- 支持桌面端（推荐）
- 平板适配
- 移动端基础支持

## 📈 性能优化

### 前端优化
- 图片懒加载
- 路由懒加载
- 分页加载
- 虚拟滚动（计划中）
- 静态资源缓存

### 后端优化
- 数据库索引
- SQL 查询优化
- COS 图片处理
- 缓存机制（计划中）

## 🔧 配置说明

### 后端配置项
详见 `API文档.md` 中的配置章节

### 前端配置项
详见 `web/vite.config.ts`

## 📝 待实现功能

- [ ] 照片分享功能
- [ ] 评论功能
- [ ] 照片对比
- [ ] AI 自动标签
- [ ] 人脸搜索优化
- [ ] 视频播放优化
- [ ] 移动端 App
- [ ] 批量下载
- [ ] 照片编辑
- [ ] 相册幻灯片

## 🐛 已知问题

1. 大文件上传可能超时
2. 地图在某些网络环境下加载慢
3. 移动端体验待优化

## 🤝 贡献指南

欢迎提交 Issue 和 Pull Request！

## 📄 许可证

MIT License

## 📞 联系方式

如有问题，请查看：
- `API文档.md` - API 接口文档
- `web/README.md` - 前端详细文档
- `web/QUICK_START.md` - 快速启动指南

---

**版本**: 1.0.0  
**更新时间**: 2025-12-10  
**作者**: MPM Team
